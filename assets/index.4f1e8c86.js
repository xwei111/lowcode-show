import{n as g,r as b,w as h,f as A,t as k,m as S,u as D,k as H}from"./index.2d473fb6.js";import{T as R}from"./index.f92c4109.js";import{g as V}from"./router.05a83631.js";import{a as y}from"./index.b06e3bcc.js";import{F as j,u as E,C as $}from"./index.8a40ba8e.js";const O={field:[{required:!0,message:"\u8BF7\u8F93\u5165\u5B57\u6BB5\u540D",trigger:"blur"}],fn:[{required:!0,message:"\u8BF7\u8F93\u5165\u65B9\u6CD5\u540D",trigger:"blur"}]},I=[{value:"GET",label:"GET"},{value:"POST",label:"POST"}],F=[{value:"0",label:"\u5426"},{value:"1",label:"\u662F"}],T={field:void 0,fn:void 0,url:void 0,method:void 0,pageId:void 0,init:"0"},P=[{label:"\u5B57\u6BB5",type:"input",prop:"field",clearable:!0},{label:"\u65B9\u6CD5\u540D",type:"input",prop:"fn",clearable:!0},{label:"\u63A5\u53E3\u5730\u5740",type:"input",prop:"url",clearable:!0},{label:"\u8BF7\u6C42\u65B9\u5F0F",type:"select",prop:"method",options:I,clearable:!0},{label:"\u9875\u9762\u6807\u8BB0",type:"select",prop:"pageId",options:[],clearable:!0},{label:"\u9879\u76EE\u521D\u59CB\u5316\u89E6\u53D1",type:"select",prop:"init",options:F}];const w={props:{projectId:[String,Number],visible:Boolean,detail:Object,pageOptions:Array},components:{Form:j},setup(s,{emit:e}){const{addDataSystem:t,updateDataSystem:a}=y.dataApis,u=b(),_=b(!1),d=E({formRef:u,formData:T,formConfig:P}),m=()=>{e("closeHandle"),d.resetHandle()},c=()=>{d.submitHandle(()=>{const{projectId:o,detail:i}=s,{id:l}=i!=null?i:{};l?a(l,d.formData).then(p=>{p&&e("successHandle"),m()}):t({projectId:o,...d.formData}).then(p=>{p&&e("successHandle"),m()})})};h(()=>s.visible,o=>{var i;_.value=o,o&&s.detail&&(d.loopFormData((l,p)=>{var r,f,v;l[p]=p==="method"?((r=s.detail)==null?void 0:r.method)||"GET":p==="init"?((f=s.detail)==null?void 0:f.init)||"0":(v=s.detail)==null?void 0:v[p]}),d.setConfig("pageId","options",(i=s.pageOptions)==null?void 0:i.map(l=>({value:l.id,label:`${l.name}(${l.code})`}))))});const n=A({formApis:d});return{formRef:u,formRules:O,dialogVisible:_,onSubmit:c,closeHandle:m,...k(n)}}};var B=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"\u914D\u7F6E\u6570\u636E",top:"20px",width:"40%",visible:e.dialogVisible,"before-close":e.closeHandle},on:{"update:visible":function(a){e.dialogVisible=a}}},[t("Form",{ref:"formRef",attrs:{inline:!1,formConfig:e.formApis.formConfig,formData:e.formApis.formData,formRules:e.formRules}}),t("div",{staticClass:"footer"},[t("el-button",{on:{click:e.closeHandle}},[e._v("\u53D6\u6D88")]),t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("\u7ACB\u5373\u521B\u5EFA")])],1)],1)},G=[],M=g(w,B,G,!1,null,"3937ff43",null,null);const q=M.exports;const z={components:{CodeEdit:$},props:{visible:Boolean,detail:Object},setup(s,{emit:e}){const{dataApis:{updateDataSystem:t}}=y,a=b(),u=b(!1),{run:_}=S(),d=()=>{var c,n;(n=(c=a.value)==null?void 0:c.monacoEditor)==null||n.setValue(""),e("closeHandle")},m=()=>{var n,o,i,l;const c=(i=(o=(n=a.value)==null?void 0:n.monacoEditor)==null?void 0:o.getValue())!=null?i:"";t((l=s.detail)==null?void 0:l.id,{callback:c}).then(p=>{e("successHandle"),d()})};return h(()=>s.visible,c=>{u.value=c,c&&_(()=>{var n,o,i,l;return(l=(n=a.value)==null?void 0:n.monacoEditor)==null?void 0:l.setValue((i=(o=s.detail)==null?void 0:o.callback)!=null?i:"")},0)}),{jsRef:a,dialogVisible:u,closeHandle:d,submitHandle:m}}};var N=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"\u81EA\u5B9A\u4E49Callback",top:"20px",width:"60%",visible:e.dialogVisible,"before-close":e.closeHandle},on:{"update:visible":function(a){e.dialogVisible=a}}},[t("code-edit",{ref:"jsRef",staticStyle:{width:"100%",height:"300px"}}),t("div",{staticClass:"fotter"},[t("el-button",{on:{click:e.closeHandle}},[e._v("\u53D6\u6D88")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitHandle}},[e._v("\u4FDD\u5B58")])],1)],1)},J=[],K=g(z,N,J,!1,null,"1ea4ea24",null,null);const L=K.exports;const Q={components:{CodeEdit:$},props:{visible:Boolean,detail:Object},setup(s,{emit:e}){const{dataApis:{updateDataSystem:t}}=y,a=b(),u=b(!1),{run:_}=S(),d=()=>{var c,n;(n=(c=a.value)==null?void 0:c.monacoEditor)==null||n.setValue(""),e("closeHandle")},m=()=>{var n,o,i,l;const c=(i=(o=(n=a.value)==null?void 0:n.monacoEditor)==null?void 0:o.getValue())!=null?i:"";t((l=s.detail)==null?void 0:l.id,{params:c}).then(p=>{e("successHandle"),d()})};return h(()=>s.visible,c=>{u.value=c,c&&_(()=>{var n,o,i,l;return(l=(n=a.value)==null?void 0:n.monacoEditor)==null?void 0:l.setValue((i=(o=s.detail)==null?void 0:o.params)!=null?i:"")},0)}),{jsRef:a,dialogVisible:u,closeHandle:d,submitHandle:m}}};var U=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"\u5165\u53C2",top:"20px",width:"60%",visible:e.dialogVisible,"before-close":e.closeHandle},on:{"update:visible":function(a){e.dialogVisible=a}}},[t("code-edit",{ref:"jsRef",staticStyle:{width:"100%",height:"300px"}}),t("div",{staticClass:"fotter"},[t("el-button",{on:{click:e.closeHandle}},[e._v("\u53D6\u6D88")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitHandle}},[e._v("\u4FDD\u5B58")])],1)],1)},W=[],X=g(Q,U,W,!1,null,"e51f9ddc",null,null);const Y=X.exports,Z=[{prop:"field",label:"\u5B57\u6BB5\u540D"},{prop:"loading",label:"\u52A0\u8F7D\u72B6\u6001"},{prop:"fn",label:"\u65B9\u6CD5\u540D"},{prop:"url",label:"\u63A5\u53E3\u5730\u5740"},{prop:"method",label:"\u8BF7\u6C42\u65B9\u5F0F"},{prop:"pageId",label:"\u9875\u9762\u6807\u8BB0"},{prop:"params",label:"\u5165\u53C2"},{prop:"callback",label:"\u56DE\u8C03/\u65B9\u6CD5"},{prop:"init",label:"\u9879\u76EE\u521D\u59CB\u5316\u89E6\u53D1"},{prop:"operate",label:"\u64CD\u4F5C"}];const ee={components:{Modal:q,Edit:L,Params:Y,Table:R},setup(){const s=D(),{projectId:e}=V(),{dataApis:{getDataSystem:t,delteDataSystem:a,getPages:u}}=y,_=b([]),d=b([]),m=H(),c=H(),n=H();u({projectId:e}).then(r=>{d.value=r!=null?r:[]});const o=()=>{t({projectId:e}).then(r=>{_.value=r!=null?r:[],s.setConfigs(_.value)})};o();const i=r=>{a(r.id).then(()=>o())},l=r=>{var v,x;const f=(x=(v=d.value)==null?void 0:v.find(C=>C.id===r))!=null?x:null;return f?`${f==null?void 0:f.name}(${f==null?void 0:f.code})`:"- -"},p=A({modalApis:m,editApis:c,paramsApis:n});return{projectId:e,store:s,columns:Z,tableData:_,pageOptions:d,getSystem:o,getPage:l,deleteHandle:i,...k(p)}}};var te=function(){var e=this,t=e._self._c;return t("div",{staticClass:"data_content"},[t("div",{staticClass:"data_header"},[e._v("\u6570\u636E\u914D\u7F6E")]),t("div",{staticClass:"data_wraper"},[t("div",{staticClass:"data_operate"},[t("el-button",{attrs:{type:"primary"},on:{click:()=>e.modalApis.openHandle({})}},[e._v("\u65B0\u589E")])],1),t("Table",{attrs:{data:e.tableData,columns:e.columns},scopedSlots:e._u([{key:"loading",fn:function({row:a}){return[t("span",[e._v(e._s(a.field)+"loading")])]}},{key:"callback",fn:function({row:a}){return[t("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(a.callback?"\u5DF2\u5B58\u5728":"\u65E0"))]),t("el-button",{attrs:{type:"text"},on:{click:()=>e.editApis.openHandle(a)}},[e._v("\u524D\u5F80\u81EA\u5B9A\u4E49")])]}},{key:"params",fn:function({row:a}){return[t("span",{staticStyle:{"margin-right":"5px"}},[e._v(e._s(a.params?"\u5DF2\u5B58\u5728":"\u65E0"))]),t("el-button",{attrs:{type:"text"},on:{click:()=>e.paramsApis.openHandle(a)}},[e._v("\u7F16\u8F91")])]}},{key:"pageId",fn:function({row:a}){return[t("span",[e._v(e._s(e.getPage(a.pageId)))])]}},{key:"init",fn:function({row:a}){return[t("span",[e._v(e._s(a.init==="1"?"\u662F":"\u5426"))])]}},{key:"operate",fn:function({row:a}){return[t("el-button",{attrs:{type:"text"},on:{click:()=>e.modalApis.openHandle(a)}},[e._v("\u7F16\u8F91")]),t("el-button",{attrs:{type:"text"},on:{click:function(u){return e.deleteHandle(a)}}},[e._v("\u5220\u9664")])]}}])})],1),t("Modal",{attrs:{projectId:e.projectId,visible:e.modalApis.visible,detail:e.modalApis.detail,pageOptions:e.pageOptions},on:{closeHandle:e.modalApis.closeHandle,successHandle:()=>e.getSystem()}}),t("Edit",{attrs:{visible:e.editApis.visible,detail:e.editApis.detail},on:{closeHandle:e.editApis.closeHandle,successHandle:()=>e.getSystem()}}),t("Params",{attrs:{visible:e.paramsApis.visible,detail:e.paramsApis.detail},on:{closeHandle:e.paramsApis.closeHandle,successHandle:()=>e.getSystem()}})],1)},ae=[],se=g(ee,te,ae,!1,null,"d829cb8f",null,null);const de=se.exports;export{de as default};
